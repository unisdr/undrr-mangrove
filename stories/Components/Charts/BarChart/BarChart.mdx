import { Meta, Story, Canvas, Source } from '@storybook/blocks';
import BarChartProcessor from './BarChart';
import Fetcher from '../../Fetcher/Fetcher';
import * as BarChartStories from './BarChart.stories';
import { Loader } from '../../../Utilities/Loader/Loader';

<Meta of={BarChartStories} />

# BarChart

The `BarChart` component visualizes categorical data using D3.js. It displays bars representing data points with customizable colors, labels, and axis options.

## Props

- **`data`**: `Array<{ label: string, value: number, color: string }>` - An array of objects representing the data points. _(required)_
- **`apiData`**: `boolean` - Set to true if pulling data from the Drupal API. _(default: false) _
- **`cumulative`**: `boolean` - Set to true if a cumulative chart. _(default: false) _
- **`width`**: `number` - The width of the chart in pixels. _(required)_
- **`height`**: `number` - The height of the chart in pixels. _(required)_
- **`margin`**: `Object<{ top: number, right: number, bottom: number, left: number }>` - An object representing the chart margins. (default: `{ top: 40, right: 30, bottom: 70, left: 70 }`)
- **`color`**: `string` - The default fill color for the bars.
- **`labelColor`**: `string` - The color for the bar labels. _(default: `#FFFFFF`)_
- **`title`**: `string` - The title of the chart.
- **`type`**: `string` - The type of the chart (`COMMITMENTS` | `ORGANIZATIONS` | `DELIVERABLES`).
- **`backgroundColor`**: `string` - The color of the background.
- **`axisColor`**: `string` - The color of the axis lines.
- **`tickColor`**: `string` - The color of the tick lines.
- **`startYear`**: `string` - The start year. _(optional)_
- **`endYear`**: `string` - The end year. _(optional)_
- **`xAxisLabel`**: `string` - The label for the x-axis. _(optional)_
- **`yAxisLabel`**: `string` - The label for the y-axis. _(optional)_
- **`dataSource`**: `string` - The data source description. _(optional)_
- **`ariaLabel`**: `string` - ARIA label for accessibility. _(default: "Bar chart showing data")_
- **`ariaDescription`**: `string` - A description of the chart content for screen readers.

## Usage

To use the `BarChart` component, import it into your React application and provide the required props.

This page shows "bring it all together examples of fetching the data and rendering. It therefore uses Fetcher and Loader that are not stricly required to show a bargraph.

### BarChart for Commitments

<Fetcher
  api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
  queryParams={{ items_per_page: 1000 }}
  render={({ isLoading, data }) => (
    <>
      {isLoading ? (
        <Loader />
      ) : (
        <BarChartProcessor
          data={data}
          width={1000}
          height={300}
          startYear={2017}
          endYear={2030}
          cumulative={true}
          margin={{ top: 10, right: 0, bottom: 10, left: 0 }}
          backgroundColor="#EEE"
          labelColor="#9CA3AF"
          axisColor="#9CA3AF"
          tickColor="none"
          title=""
          type="COMMITMENTS"
          xAxisLabel=""
          yAxisLabel=""
          dataSource=""
          ariaLabel="Bar chart showing the number of commitments by year"
          ariaDescription="This chart displays the number of commitments made each year based on fetched API data."
          apiData="true"
        />
      )}
    </>
  )}
/>

### BarChart for Organizations

<Fetcher
  api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics"
  queryParams={{ items_per_page: 1000 }}
  render={({ isLoading, data }) => (
    <>
      {isLoading ? (
        <Loader />
      ) : (
        <BarChartProcessor
          data={data}
          width={1000}
          height={300}
          margin={{ top: 10, right: 0, bottom: 10, left: 0 }}
          labelColor="#9CA3AF"
          axisColor="#9CA3AF"
          tickColor="none"
          title=""
          type="ORGANIZATIONS"
          xAxisLabel=""
          yAxisLabel=""
          dataSource=""
          ariaLabel="Bar chart showing the number of organizations by year"
          ariaDescription="This chart displays the number of participating organizations each year based on fetched API data."
          apiData="true"
        />
      )}
    </>
  )}
/>

### BarChart for Deliverables

<Fetcher
  api="https://sfvc-migration.undrr.org/api/v2/content/commitment-deliverables-metrics"
  queryParams={{ items_per_page: 1000 }}
  render={({ isLoading, data }) => (
    <>
      {isLoading ? (
        <Loader />
      ) : (
        <BarChartProcessor
          data={data}
          width={1000}
          height={300}
          margin={{ top: 10, right: 0, bottom: 10, left: 0 }}
          labelColor="#9CA3AF"
          axisColor="#9CA3AF"
          tickColor="none"
          title=""
          type="DELIVERABLES"
          xAxisLabel=""
          yAxisLabel=""
          dataSource=""
          ariaLabel="Bar chart showing the number of deliverables by year"
          ariaDescription="This chart displays the number of deliverables made each year based on fetched API data."
          apiData="true"
        />
      )}
    </>
  )}
/>

### Accessibility

Ensure keyboard navigation and ARIA roles are properly implemented for enhanced accessibility.

### Changelog

1.0 â€” Initial release of the component
