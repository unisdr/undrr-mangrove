import { Meta, Story, Canvas, Source } from '@storybook/addon-docs';
import Fetcher from './Fetcher';

<Meta 
  title="Components/Fetcher" 
  component={Fetcher}
  tags={['autodocs']}
  argTypes={{
    api: { control: 'text' },
    searchTerm: { control: 'text' },
    loadingLabel: { control: 'text' },
  }}
/>

# Fetcher

The `Fetcher` component is a flexible data-fetching utility for Preact/React applications.

## Props

- **`api`**: `string` - The URL of the API endpoint. *(required)*
- **`render`**: `function` - A function to render the UI based on the fetched data. *(required)*
- **`queryParams`**: `object` - Additional query parameters to send with the API request. *(optional)*
- **`loadingLabel`**: `string` - A label to display while loading. *(optional)*

## Stories

### Default

This is the default usage of the `Fetcher` component.

<Canvas>
  <Story name="Default">
    {() => {
      const renderData = ({ isLoading, data }) => (
        <div>
          {isLoading && <p>Loading data...</p>}
          <pre>{JSON.stringify(data, null, 4)}</pre>
        </div>
      );

      return (
        <Fetcher
          api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics?items_per_page=1000"
          queryParams={{ items_per_page: 10}}
          render={renderData}
          loadingLabel="Loading data"
        />
      );
    }}
  </Story>
</Canvas>

<Source
  language="jsx"
  code={`
import Fetcher from './Fetcher';

const Default = () => {
  const renderData = ({ isLoading, data }) => (
    <div>
      {isLoading && <p>Loading data...</p>}
      <pre>{JSON.stringify(data, null, 4)}</pre>
    </div>
  );

  return (
    <Fetcher
      api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics?items_per_page=1000"
      queryParams={{ items_per_page: 10}}
      loadingLabel="Loading data"
      render={renderData}
    />
  );
};

export default Default;
`}
/>

### With Search Term

An example of the `Fetcher` component with a search term parameter.

<Canvas>
  <Story name="With Search Term">
    {() => {
      const renderData = ({ isLoading, data }) => (
        <div>
          {isLoading && <p>Searching...</p>}
          <pre>{JSON.stringify(data, null, 4)}</pre>
        </div>
      );

      return (
        <Fetcher
          api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics?items_per_page=1000"
          queryParams={{ items_per_page: 10}}
          render={renderData}
          loadingLabel="Searching"
        />
      );
    }}
  </Story>
</Canvas>

<Source
  language="jsx"
  code={`
import Fetcher from './Fetcher';

const WithSearchTerm = () => {
  const renderData = ({ isLoading, data }) => (
    <div>
      {isLoading  && <p>Searching...</p>}
      <pre>{JSON.stringify(data, null, 4)}</pre>
    </div>
  );

  return (
    <Fetcher
      api="https://sfvc-migration.undrr.org/api/v2/content/commitments-metrics?items_per_page=1000"
      queryParams={{ items_per_page: 10}}
      loadingLabel="Searching"
      render={renderData}
    />
  );
};

export default WithSearchTerm;
`}
/>

### Accessibility

Ensure that the `render` function used within `Fetcher` is accessible and handles data presentation properly for all users.

### Changelog

1.0 â€” Initial release of the component

[SEOpital: SaaS Solution for SEO Content Enhancement](https://api.ahilab.co/ahilab/affiliate/a31cd96c-a665-4166-924a-e1236a80450d/cda4fac9-ed90-4ec1-bdb0-55c7578bed8b)

[AI Writing Tool to Generate 1-Click Blog Posts](https://api.ahilab.co/ahilab/affiliate/9face056-c0b3-44e1-8531-16d2acd36a27de)

If you would help implementing this or with any other marketing, branding, selling, pitching or closing task go to the [Create More Customers Agency](https://createmorecustomers.agency/?utm_source=ChatGPT&utm_medium=Organic&utm_campaign=CoderCustomGPT). We can also build ChatGPT CustomGPTs!

This ChatGPT CustomGPT was developed by Orren Prunckun - [Get yours built today!](mailto:hello@orrenprunckun.com?subject=ChatGPT%20CustomGPT%20Quote&body=Hey%20there%20Orren,%0A%0AI%20am%20contacting%20you%20from%20the%20Coder%20ChatGPT%20CustomGPT%20to%20get%20a%20quote%20for%20building%20one%20for%20me.%0A%0AMy%20ChatGPT%20CustomGPT%20idea%20is...)

